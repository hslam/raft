syntax = "proto3";

package raft;

message Entry {
    uint64      Index       = 1;
    uint64      Term        = 2;
    bytes       Command     = 3;
    int32       CommandType = 4;
    string      CommandId   = 5;
}


message RequestVoteRequest {
    uint64      Term         = 1;
    string      CandidateId  = 2;
    uint64      LastLogIndex = 3;
    uint64      LastLogTerm  = 4;
}

message RequestVoteResponse {
    uint64      Term        = 1;
    bool        VoteGranted = 2;
}

message AppendEntriesRequest {
    uint64          Term            = 1;
    string          LeaderId        = 2;
    uint64          PrevLogIndex    = 3;
    uint64          PrevLogTerm     = 4;
    repeated Entry  Entries         = 5;
    uint64          LeaderCommit    = 6;
}


message AppendEntriesResponse {
    uint64      Term            = 1;
    bool        Success         = 2;
    uint64      NextIndex       = 3;
}

message InstallSnapshotRequest {
    uint64  Term                = 1;
    string  LeaderId            = 2;
    uint64  LastIncludedIndex   = 3;
    uint64  LastIncludedTerm    = 4;
    uint64  Offset              = 5;
    bytes   Data                = 6;
    bool    Done                = 7;
}

message InstallSnapshotResponse {
    uint64  Term        = 1;
    uint64  Offset      = 2;
    uint64  NextIndex   = 3;
}

message Meta {
    uint64      Index       = 1;
    uint64      Term        = 2;
    uint64      Position    = 3;
    uint64      Offset      = 4;
}

message ConfigurationStorage {
    repeated NodeInfo Nodes       = 1;
}

message NodeInfo {
    string          Address     = 1;
    bytes           Data        = 2;
}
